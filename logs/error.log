{"_message":"User validation failed","environment":"development","errors":{"address.city":{"kind":"required","message":"Path `address.city` is required.","name":"ValidatorError","path":"address.city","properties":{"message":"Path `address.city` is required.","path":"address.city","type":"required"}},"address.county":{"kind":"required","message":"Path `address.county` is required.","name":"ValidatorError","path":"address.county","properties":{"message":"Path `address.county` is required.","path":"address.county","type":"required"}},"address.street":{"kind":"required","message":"Path `address.street` is required.","name":"ValidatorError","path":"address.street","properties":{"message":"Path `address.street` is required.","path":"address.street","type":"required"}},"address.subCounty":{"kind":"required","message":"Path `address.subCounty` is required.","name":"ValidatorError","path":"address.subCounty","properties":{"message":"Path `address.subCounty` is required.","path":"address.subCounty","type":"required"}},"userId":{"kind":"required","message":"Path `userId` is required.","name":"ValidatorError","path":"userId","properties":{"message":"Path `userId` is required.","path":"userId","type":"required"}}},"level":"error","message":"Registration failed: User validation failed: address.subCounty: Path `address.subCounty` is required., address.county: Path `address.county` is required., address.city: Path `address.city` is required., address.street: Path `address.street` is required., userId: Path `userId` is required.","service":"medblock-backend","stack":"ValidationError: User validation failed: address.subCounty: Path `address.subCounty` is required., address.county: Path `address.county` is required., address.city: Path `address.city` is required., address.street: Path `address.street` is required., userId: Path `userId` is required.\n    at Document.invalidate (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/document.js:3352:32)\n    at /home/josva/Desktop/MedBlock/node_modules/mongoose/lib/document.js:3113:17\n    at /home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schemaType.js:1407:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)","timestamp":"2025-06-26 20:34:47"}
{"_message":"User validation failed","environment":"development","errors":{"userId":{"kind":"required","message":"Path `userId` is required.","name":"ValidatorError","path":"userId","properties":{"message":"Path `userId` is required.","path":"userId","type":"required"}}},"level":"error","message":"Registration failed: User validation failed: userId: Path `userId` is required.","service":"medblock-backend","stack":"ValidationError: User validation failed: userId: Path `userId` is required.\n    at Document.invalidate (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/document.js:3352:32)\n    at /home/josva/Desktop/MedBlock/node_modules/mongoose/lib/document.js:3113:17\n    at /home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schemaType.js:1407:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)","timestamp":"2025-06-26 20:39:29"}
{"_message":"User validation failed","environment":"development","errors":{"userId":{"kind":"required","message":"Path `userId` is required.","name":"ValidatorError","path":"userId","properties":{"message":"Path `userId` is required.","path":"userId","type":"required"}}},"level":"error","message":"Registration failed: User validation failed: userId: Path `userId` is required.","service":"medblock-backend","stack":"ValidationError: User validation failed: userId: Path `userId` is required.\n    at Document.invalidate (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/document.js:3352:32)\n    at /home/josva/Desktop/MedBlock/node_modules/mongoose/lib/document.js:3113:17\n    at /home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schemaType.js:1407:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)","timestamp":"2025-06-26 20:40:52"}
{"_message":"User validation failed","environment":"development","errors":{"userId":{"kind":"required","message":"Path `userId` is required.","name":"ValidatorError","path":"userId","properties":{"message":"Path `userId` is required.","path":"userId","type":"required"}}},"level":"error","message":"Registration failed: User validation failed: userId: Path `userId` is required.","service":"medblock-backend","stack":"ValidationError: User validation failed: userId: Path `userId` is required.\n    at Document.invalidate (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/document.js:3352:32)\n    at /home/josva/Desktop/MedBlock/node_modules/mongoose/lib/document.js:3113:17\n    at /home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schemaType.js:1407:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)","timestamp":"2025-06-26 20:43:56"}
{"_message":"User validation failed","environment":"development","errors":{"userId":{"kind":"required","message":"Path `userId` is required.","name":"ValidatorError","path":"userId","properties":{"message":"Path `userId` is required.","path":"userId","type":"required"}}},"level":"error","message":"Registration failed: User validation failed: userId: Path `userId` is required.","service":"medblock-backend","stack":"ValidationError: User validation failed: userId: Path `userId` is required.\n    at Document.invalidate (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/document.js:3352:32)\n    at /home/josva/Desktop/MedBlock/node_modules/mongoose/lib/document.js:3113:17\n    at /home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schemaType.js:1407:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)","timestamp":"2025-06-26 20:45:00"}
{"_message":"User validation failed","environment":"development","errors":{"userId":{"kind":"required","message":"Path `userId` is required.","name":"ValidatorError","path":"userId","properties":{"message":"Path `userId` is required.","path":"userId","type":"required"}}},"level":"error","message":"Registration failed: User validation failed: userId: Path `userId` is required.","service":"medblock-backend","stack":"ValidationError: User validation failed: userId: Path `userId` is required.\n    at Document.invalidate (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/document.js:3352:32)\n    at /home/josva/Desktop/MedBlock/node_modules/mongoose/lib/document.js:3113:17\n    at /home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schemaType.js:1407:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)","timestamp":"2025-06-26 21:15:09"}
{"environment":"development","level":"error","message":"Unhandled Promise Rejection: logger.security is not a function","service":"medblock-backend","stack":"TypeError: logger.security is not a function\n    at authenticateToken (/home/josva/Desktop/MedBlock/src/middleware/auth.js:68:14)\n    at Layer.handle [as handle_request] (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:328:13)\n    at /home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:346:12)\n    at next (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:175:3)\n    at router (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:47:12)\n    at Layer.handle [as handle_request] (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:328:13)","timestamp":"2025-06-26 21:57:18"}
{"environment":"development","kind":"ObjectId","level":"error","message":"Authentication error: Cast to ObjectId failed for value \"b0e60435-b552-4d48-a3fa-06ba9957ac17\" (type string) at path \"_id\" for model \"User\"","path":"_id","reason":{},"service":"medblock-backend","stack":"CastError: Cast to ObjectId failed for value \"b0e60435-b552-4d48-a3fa-06ba9957ac17\" (type string) at path \"_id\" for model \"User\"\n    at SchemaObjectId.cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schema/objectId.js:251:11)\n    at SchemaType.applySetters (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schemaType.js:1255:12)\n    at SchemaType.castForQuery (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schemaType.js:1673:17)\n    at cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/cast.js:390:32)\n    at Query.cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:5055:12)\n    at Query._castConditions (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:2351:10)\n    at model.Query._findOne (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:2674:8)\n    at model.Query.exec (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:4604:80)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async authenticateToken (/home/josva/Desktop/MedBlock/src/middleware/auth.js:29:18)","stringValue":"\"b0e60435-b552-4d48-a3fa-06ba9957ac17\"","timestamp":"2025-06-26 22:02:12","value":"b0e60435-b552-4d48-a3fa-06ba9957ac17","valueType":"string"}
{"_message":"Patient validation failed","environment":"development","errors":{"address.city":{"kind":"required","message":"Path `address.city` is required.","name":"ValidatorError","path":"address.city","properties":{"message":"Path `address.city` is required.","path":"address.city","type":"required"}},"address.street":{"kind":"required","message":"Path `address.street` is required.","name":"ValidatorError","path":"address.street","properties":{"message":"Path `address.street` is required.","path":"address.street","type":"required"}},"emergencyContact.name":{"kind":"required","message":"Path `emergencyContact.name` is required.","name":"ValidatorError","path":"emergencyContact.name","properties":{"message":"Path `emergencyContact.name` is required.","path":"emergencyContact.name","type":"required"}},"emergencyContact.phoneNumber":{"kind":"required","message":"Path `emergencyContact.phoneNumber` is required.","name":"ValidatorError","path":"emergencyContact.phoneNumber","properties":{"message":"Path `emergencyContact.phoneNumber` is required.","path":"emergencyContact.phoneNumber","type":"required"}},"emergencyContact.relationship":{"kind":"required","message":"Path `emergencyContact.relationship` is required.","name":"ValidatorError","path":"emergencyContact.relationship","properties":{"message":"Path `emergencyContact.relationship` is required.","path":"emergencyContact.relationship","type":"required"}},"password":{"kind":"required","message":"Path `password` is required.","name":"ValidatorError","path":"password","properties":{"message":"Path `password` is required.","path":"password","type":"required"}},"patientId":{"kind":"required","message":"Path `patientId` is required.","name":"ValidatorError","path":"patientId","properties":{"message":"Path `patientId` is required.","path":"patientId","type":"required"}}},"level":"error","message":"Create patient failed: Patient validation failed: password: Path `password` is required., emergencyContact.phoneNumber: Path `emergencyContact.phoneNumber` is required., emergencyContact.relationship: Path `emergencyContact.relationship` is required., emergencyContact.name: Path `emergencyContact.name` is required., address.city: Path `address.city` is required., address.street: Path `address.street` is required., patientId: Path `patientId` is required.","service":"medblock-backend","stack":"ValidationError: Patient validation failed: password: Path `password` is required., emergencyContact.phoneNumber: Path `emergencyContact.phoneNumber` is required., emergencyContact.relationship: Path `emergencyContact.relationship` is required., emergencyContact.name: Path `emergencyContact.name` is required., address.city: Path `address.city` is required., address.street: Path `address.street` is required., patientId: Path `patientId` is required.\n    at Document.invalidate (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/document.js:3352:32)\n    at /home/josva/Desktop/MedBlock/node_modules/mongoose/lib/document.js:3113:17\n    at /home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schemaType.js:1407:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)","timestamp":"2025-06-26 22:51:48"}
{"_message":"Patient validation failed","environment":"development","errors":{"emergencyContact.relationship":{"kind":"enum","message":"`Brother` is not a valid enum value for path `emergencyContact.relationship`.","name":"ValidatorError","path":"emergencyContact.relationship","properties":{"enumValues":["spouse","parent","child","sibling","friend","other"],"message":"`Brother` is not a valid enum value for path `emergencyContact.relationship`.","path":"emergencyContact.relationship","type":"enum","value":"Brother"},"value":"Brother"}},"level":"error","message":"Create patient failed: Patient validation failed: emergencyContact.relationship: `Brother` is not a valid enum value for path `emergencyContact.relationship`.","service":"medblock-backend","stack":"ValidationError: Patient validation failed: emergencyContact.relationship: `Brother` is not a valid enum value for path `emergencyContact.relationship`.\n    at Document.invalidate (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/document.js:3352:32)\n    at /home/josva/Desktop/MedBlock/node_modules/mongoose/lib/document.js:3113:17\n    at /home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schemaType.js:1407:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)","timestamp":"2025-06-26 22:55:11"}
{"_message":"Patient validation failed","environment":"development","errors":{"emergencyContact.relationship":{"kind":"enum","message":"`Mother` is not a valid enum value for path `emergencyContact.relationship`.","name":"ValidatorError","path":"emergencyContact.relationship","properties":{"enumValues":["spouse","parent","child","sibling","friend","other"],"message":"`Mother` is not a valid enum value for path `emergencyContact.relationship`.","path":"emergencyContact.relationship","type":"enum","value":"Mother"},"value":"Mother"}},"level":"error","message":"Create patient failed: Patient validation failed: emergencyContact.relationship: `Mother` is not a valid enum value for path `emergencyContact.relationship`.","service":"medblock-backend","stack":"ValidationError: Patient validation failed: emergencyContact.relationship: `Mother` is not a valid enum value for path `emergencyContact.relationship`.\n    at Document.invalidate (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/document.js:3352:32)\n    at /home/josva/Desktop/MedBlock/node_modules/mongoose/lib/document.js:3113:17\n    at /home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schemaType.js:1407:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)","timestamp":"2025-06-26 22:56:37"}
{"environment":"development","level":"error","message":"Create patient failed: patient.getSummary is not a function","service":"medblock-backend","stack":"TypeError: patient.getSummary is not a function\n    at /home/josva/Desktop/MedBlock/src/routes/patients.js:208:26\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-06-26 23:08:27"}
{"address":"::","code":"EADDRINUSE","environment":"development","errno":-98,"level":"error","message":"Uncaught Exception: listen EADDRINUSE: address already in use :::3000","port":3000,"service":"medblock-backend","stack":"Error: listen EADDRINUSE: address already in use :::3000\n    at Server.setupListenHandle [as _listen2] (node:net:1939:16)\n    at listenInCluster (node:net:1996:12)\n    at Server.listen (node:net:2101:7)\n    at Function.listen (/home/josva/Desktop/MedBlock/node_modules/express/lib/application.js:635:24)\n    at startServer (/home/josva/Desktop/MedBlock/src/server.js:199:9)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","syscall":"listen","timestamp":"2025-06-26 23:22:58"}
{"environment":"development","level":"error","message":"Authentication failed: Invalid email or password","service":"medblock-backend","stack":"Error: Invalid email or password\n    at userSchema.statics.authenticate (/home/josva/Desktop/MedBlock/src/models/User.js:439:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async /home/josva/Desktop/MedBlock/src/routes/auth.js:144:18","timestamp":"2025-06-26 23:23:04"}
{"environment":"development","level":"error","message":"Login failed: Invalid email or password","service":"medblock-backend","stack":"Error: Invalid email or password\n    at userSchema.statics.authenticate (/home/josva/Desktop/MedBlock/src/models/User.js:439:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async /home/josva/Desktop/MedBlock/src/routes/auth.js:144:18","timestamp":"2025-06-26 23:23:04"}
{"environment":"development","level":"error","message":"Authentication failed: Invalid email or password","service":"medblock-backend","stack":"Error: Invalid email or password\n    at userSchema.statics.authenticate (/home/josva/Desktop/MedBlock/src/models/User.js:439:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async /home/josva/Desktop/MedBlock/src/routes/auth.js:144:18","timestamp":"2025-06-26 23:23:09"}
{"environment":"development","level":"error","message":"Login failed: Invalid email or password","service":"medblock-backend","stack":"Error: Invalid email or password\n    at userSchema.statics.authenticate (/home/josva/Desktop/MedBlock/src/models/User.js:439:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async /home/josva/Desktop/MedBlock/src/routes/auth.js:144:18","timestamp":"2025-06-26 23:23:09"}
{"_message":"User validation failed","environment":"development","errors":{"address.city":{"kind":"required","message":"Path `address.city` is required.","name":"ValidatorError","path":"address.city","properties":{"message":"Path `address.city` is required.","path":"address.city","type":"required"}},"address.county":{"kind":"required","message":"Path `address.county` is required.","name":"ValidatorError","path":"address.county","properties":{"message":"Path `address.county` is required.","path":"address.county","type":"required"}},"address.street":{"kind":"required","message":"Path `address.street` is required.","name":"ValidatorError","path":"address.street","properties":{"message":"Path `address.street` is required.","path":"address.street","type":"required"}},"address.subCounty":{"kind":"required","message":"Path `address.subCounty` is required.","name":"ValidatorError","path":"address.subCounty","properties":{"message":"Path `address.subCounty` is required.","path":"address.subCounty","type":"required"}}},"level":"error","message":"Registration failed: User validation failed: address.subCounty: Path `address.subCounty` is required., address.county: Path `address.county` is required., address.city: Path `address.city` is required., address.street: Path `address.street` is required.","service":"medblock-backend","stack":"ValidationError: User validation failed: address.subCounty: Path `address.subCounty` is required., address.county: Path `address.county` is required., address.city: Path `address.city` is required., address.street: Path `address.street` is required.\n    at Document.invalidate (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/document.js:3352:32)\n    at /home/josva/Desktop/MedBlock/node_modules/mongoose/lib/document.js:3113:17\n    at /home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schemaType.js:1407:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)","timestamp":"2025-06-26 23:23:21"}
{"code":11000,"environment":"development","errorLabelSet":{},"errorResponse":{"code":11000,"errmsg":"E11000 duplicate key error collection: medblock.users index: userId_1 dup key: { userId: null }","index":0,"keyPattern":{"userId":1},"keyValue":{"userId":null}},"index":0,"keyPattern":{"userId":1},"keyValue":{"userId":null},"level":"error","message":"Registration failed: E11000 duplicate key error collection: medblock.users index: userId_1 dup key: { userId: null }","service":"medblock-backend","stack":"MongoServerError: E11000 duplicate key error collection: medblock.users index: userId_1 dup key: { userId: null }\n    at InsertOneOperation.execute (/home/josva/Desktop/MedBlock/node_modules/mongodb/lib/operations/insert.js:51:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async tryOperation (/home/josva/Desktop/MedBlock/node_modules/mongodb/lib/operations/execute_operation.js:207:20)\n    at async executeOperation (/home/josva/Desktop/MedBlock/node_modules/mongodb/lib/operations/execute_operation.js:75:16)\n    at async Collection.insertOne (/home/josva/Desktop/MedBlock/node_modules/mongodb/lib/collection.js:157:16)","timestamp":"2025-06-26 23:23:25"}
{"code":11000,"environment":"development","errorLabelSet":{},"errorResponse":{"code":11000,"errmsg":"E11000 duplicate key error collection: medblock.users index: userId_1 dup key: { userId: null }","index":0,"keyPattern":{"userId":1},"keyValue":{"userId":null}},"index":0,"keyPattern":{"userId":1},"keyValue":{"userId":null},"level":"error","message":"Registration failed: E11000 duplicate key error collection: medblock.users index: userId_1 dup key: { userId: null }","service":"medblock-backend","stack":"MongoServerError: E11000 duplicate key error collection: medblock.users index: userId_1 dup key: { userId: null }\n    at InsertOneOperation.execute (/home/josva/Desktop/MedBlock/node_modules/mongodb/lib/operations/insert.js:51:19)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async tryOperation (/home/josva/Desktop/MedBlock/node_modules/mongodb/lib/operations/execute_operation.js:207:20)\n    at async executeOperation (/home/josva/Desktop/MedBlock/node_modules/mongodb/lib/operations/execute_operation.js:75:16)\n    at async Collection.insertOne (/home/josva/Desktop/MedBlock/node_modules/mongodb/lib/collection.js:157:16)","timestamp":"2025-06-26 23:23:53"}
{"environment":"development","kind":"ObjectId","level":"error","message":"Get patient failed: Cast to ObjectId failed for value \"PT-00123\" (type string) at path \"_id\" for model \"Patient\"","path":"_id","reason":{},"service":"medblock-backend","stack":"CastError: Cast to ObjectId failed for value \"PT-00123\" (type string) at path \"_id\" for model \"Patient\"\n    at SchemaObjectId.cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schema/objectId.js:251:11)\n    at SchemaType.applySetters (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schemaType.js:1255:12)\n    at SchemaType.castForQuery (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schemaType.js:1673:17)\n    at cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/cast.js:390:32)\n    at cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/cast.js:76:20)\n    at Query.cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:5055:12)\n    at Query._castConditions (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:2351:10)\n    at model.Query._findOne (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:2674:8)\n    at model.Query.exec (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:4604:80)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","stringValue":"\"PT-00123\"","timestamp":"2025-06-26 23:43:34","value":"PT-00123","valueType":"string"}
{"environment":"development","kind":"ObjectId","level":"error","message":"Get patient failed: Cast to ObjectId failed for value \"PT-00123\" (type string) at path \"_id\" for model \"Patient\"","path":"_id","reason":{},"service":"medblock-backend","stack":"CastError: Cast to ObjectId failed for value \"PT-00123\" (type string) at path \"_id\" for model \"Patient\"\n    at SchemaObjectId.cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schema/objectId.js:251:11)\n    at SchemaType.applySetters (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schemaType.js:1255:12)\n    at SchemaType.castForQuery (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schemaType.js:1673:17)\n    at cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/cast.js:390:32)\n    at cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/cast.js:76:20)\n    at Query.cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:5055:12)\n    at Query._castConditions (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:2351:10)\n    at model.Query._findOne (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:2674:8)\n    at model.Query.exec (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:4604:80)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","stringValue":"\"PT-00123\"","timestamp":"2025-06-26 23:44:37","value":"PT-00123","valueType":"string"}
{"environment":"development","kind":"ObjectId","level":"error","message":"Get patient failed: Cast to ObjectId failed for value \"PT-00123\" (type string) at path \"_id\" for model \"Patient\"","path":"_id","reason":{},"service":"medblock-backend","stack":"CastError: Cast to ObjectId failed for value \"PT-00123\" (type string) at path \"_id\" for model \"Patient\"\n    at SchemaObjectId.cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schema/objectId.js:251:11)\n    at SchemaType.applySetters (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schemaType.js:1255:12)\n    at SchemaType.castForQuery (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schemaType.js:1673:17)\n    at cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/cast.js:390:32)\n    at cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/cast.js:76:20)\n    at Query.cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:5055:12)\n    at Query._castConditions (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:2351:10)\n    at model.Query._findOne (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:2674:8)\n    at model.Query.exec (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:4604:80)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","stringValue":"\"PT-00123\"","timestamp":"2025-06-26 23:45:25","value":"PT-00123","valueType":"string"}
{"environment":"development","kind":"ObjectId","level":"error","message":"Get patient failed: Cast to ObjectId failed for value \"PT-00123\" (type string) at path \"_id\" for model \"Patient\"","path":"_id","reason":{},"service":"medblock-backend","stack":"CastError: Cast to ObjectId failed for value \"PT-00123\" (type string) at path \"_id\" for model \"Patient\"\n    at SchemaObjectId.cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schema/objectId.js:251:11)\n    at SchemaType.applySetters (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schemaType.js:1255:12)\n    at SchemaType.castForQuery (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schemaType.js:1673:17)\n    at cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/cast.js:390:32)\n    at cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/cast.js:76:20)\n    at Query.cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:5055:12)\n    at Query._castConditions (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:2351:10)\n    at model.Query._findOne (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:2674:8)\n    at model.Query.exec (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:4604:80)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","stringValue":"\"PT-00123\"","timestamp":"2025-06-26 23:50:21","value":"PT-00123","valueType":"string"}
{"environment":"development","level":"error","message":"Unhandled Promise Rejection: logger.security is not a function","service":"medblock-backend","stack":"TypeError: logger.security is not a function\n    at authenticateToken (/home/josva/Desktop/MedBlock/src/middleware/auth.js:68:14)\n    at Layer.handle [as handle_request] (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:328:13)\n    at /home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:346:12)\n    at next (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:175:3)\n    at router (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:47:12)\n    at Layer.handle [as handle_request] (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:328:13)","timestamp":"2025-06-27 01:10:17"}
{"environment":"development","level":"error","message":"Unhandled Promise Rejection: logger.security is not a function","service":"medblock-backend","stack":"TypeError: logger.security is not a function\n    at authenticateToken (/home/josva/Desktop/MedBlock/src/middleware/auth.js:68:14)\n    at Layer.handle [as handle_request] (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:328:13)\n    at /home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:346:12)\n    at next (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:175:3)\n    at router (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:47:12)\n    at Layer.handle [as handle_request] (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:328:13)","timestamp":"2025-06-27 01:10:44"}
{"_message":"Patient validation failed","environment":"development","errors":{"address.city":{"kind":"required","message":"Path `address.city` is required.","name":"ValidatorError","path":"address.city","properties":{"message":"Path `address.city` is required.","path":"address.city","type":"required"}},"address.street":{"kind":"required","message":"Path `address.street` is required.","name":"ValidatorError","path":"address.street","properties":{"message":"Path `address.street` is required.","path":"address.street","type":"required"}},"emergencyContact.phoneNumber":{"kind":"required","message":"Path `emergencyContact.phoneNumber` is required.","name":"ValidatorError","path":"emergencyContact.phoneNumber","properties":{"message":"Path `emergencyContact.phoneNumber` is required.","path":"emergencyContact.phoneNumber","type":"required"}},"emergencyContact.relationship":{"kind":"enum","message":"`wife` is not a valid enum value for path `emergencyContact.relationship`.","name":"ValidatorError","path":"emergencyContact.relationship","properties":{"enumValues":["spouse","parent","child","sibling","friend","other"],"message":"`wife` is not a valid enum value for path `emergencyContact.relationship`.","path":"emergencyContact.relationship","type":"enum","value":"wife"},"value":"wife"},"patientId":{"kind":"required","message":"Path `patientId` is required.","name":"ValidatorError","path":"patientId","properties":{"message":"Path `patientId` is required.","path":"patientId","type":"required"}}},"level":"error","message":"Create patient failed: Patient validation failed: emergencyContact.phoneNumber: Path `emergencyContact.phoneNumber` is required., emergencyContact.relationship: `wife` is not a valid enum value for path `emergencyContact.relationship`., address.city: Path `address.city` is required., address.street: Path `address.street` is required., patientId: Path `patientId` is required.","service":"medblock-backend","stack":"ValidationError: Patient validation failed: emergencyContact.phoneNumber: Path `emergencyContact.phoneNumber` is required., emergencyContact.relationship: `wife` is not a valid enum value for path `emergencyContact.relationship`., address.city: Path `address.city` is required., address.street: Path `address.street` is required., patientId: Path `patientId` is required.\n    at Document.invalidate (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/document.js:3352:32)\n    at /home/josva/Desktop/MedBlock/node_modules/mongoose/lib/document.js:3113:17\n    at /home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schemaType.js:1407:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)","timestamp":"2025-06-27 01:14:43"}
{"environment":"development","kind":"ObjectId","level":"error","message":"Delete patient failed: Cast to ObjectId failed for value \"invalid-id-format\" (type string) at path \"_id\" for model \"Patient\"","path":"_id","reason":{},"service":"medblock-backend","stack":"CastError: Cast to ObjectId failed for value \"invalid-id-format\" (type string) at path \"_id\" for model \"Patient\"\n    at SchemaObjectId.cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schema/objectId.js:251:11)\n    at SchemaType.applySetters (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schemaType.js:1255:12)\n    at SchemaType.castForQuery (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schemaType.js:1673:17)\n    at cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/cast.js:390:32)\n    at cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/cast.js:76:20)\n    at Query.cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:5055:12)\n    at Query._castConditions (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:2351:10)\n    at model.Query._findOne (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:2674:8)\n    at model.Query.exec (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:4604:80)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","stringValue":"\"invalid-id-format\"","timestamp":"2025-06-27 01:32:24","value":"invalid-id-format","valueType":"string"}
{"environment":"development","level":"error","message":"Authentication error: logger.security is not a function","service":"medblock-backend","stack":"TypeError: logger.security is not a function\n    at authenticateToken (/home/josva/Desktop/MedBlock/src/middleware/auth.js:14:14)\n    at Layer.handle [as handle_request] (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:328:13)\n    at /home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:346:12)\n    at next (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:175:3)\n    at router (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:47:12)\n    at Layer.handle [as handle_request] (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:328:13)","timestamp":"2025-06-27 01:32:52"}
{"environment":"development","level":"error","message":"Authentication error: logger.security is not a function","service":"medblock-backend","stack":"TypeError: logger.security is not a function\n    at authenticateToken (/home/josva/Desktop/MedBlock/src/middleware/auth.js:14:14)\n    at Layer.handle [as handle_request] (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:328:13)\n    at /home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:346:12)\n    at next (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:175:3)\n    at router (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:47:12)\n    at Layer.handle [as handle_request] (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:328:13)","timestamp":"2025-06-27 01:39:58"}
{"environment":"development","level":"error","message":"Unhandled Promise Rejection: logger.security is not a function","service":"medblock-backend","stack":"TypeError: logger.security is not a function\n    at authenticateToken (/home/josva/Desktop/MedBlock/src/middleware/auth.js:68:14)\n    at Layer.handle [as handle_request] (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:328:13)\n    at /home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:346:12)\n    at next (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:175:3)\n    at router (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:47:12)\n    at Layer.handle [as handle_request] (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:328:13)","timestamp":"2025-06-27 01:40:55"}
{"environment":"development","level":"error","message":"Unhandled Promise Rejection: logger.security is not a function","service":"medblock-backend","stack":"TypeError: logger.security is not a function\n    at authenticateToken (/home/josva/Desktop/MedBlock/src/middleware/auth.js:68:14)\n    at Layer.handle [as handle_request] (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:328:13)\n    at /home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:346:12)\n    at next (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:175:3)\n    at router (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:47:12)\n    at Layer.handle [as handle_request] (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:328:13)","timestamp":"2025-06-27 01:41:20"}
{"environment":"development","kind":"ObjectId","level":"error","message":"Delete patient failed: Cast to ObjectId failed for value \"invalid-id\" (type string) at path \"_id\" for model \"Patient\"","path":"_id","reason":{},"service":"medblock-backend","stack":"CastError: Cast to ObjectId failed for value \"invalid-id\" (type string) at path \"_id\" for model \"Patient\"\n    at SchemaObjectId.cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schema/objectId.js:251:11)\n    at SchemaType.applySetters (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schemaType.js:1255:12)\n    at SchemaType.castForQuery (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schemaType.js:1673:17)\n    at cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/cast.js:390:32)\n    at cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/cast.js:76:20)\n    at Query.cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:5055:12)\n    at Query._castConditions (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:2351:10)\n    at model.Query._findOne (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:2674:8)\n    at model.Query.exec (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:4604:80)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","stringValue":"\"invalid-id\"","timestamp":"2025-06-27 01:50:55","value":"invalid-id","valueType":"string"}
{"environment":"development","level":"error","message":"Authentication error: logger.security is not a function","service":"medblock-backend","stack":"TypeError: logger.security is not a function\n    at authenticateToken (/home/josva/Desktop/MedBlock/src/middleware/auth.js:14:14)\n    at Layer.handle [as handle_request] (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:328:13)\n    at /home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:346:12)\n    at next (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:175:3)\n    at router (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:47:12)\n    at Layer.handle [as handle_request] (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:328:13)","timestamp":"2025-06-27 01:52:26"}
{"environment":"development","level":"error","message":"Unhandled Promise Rejection: logger.security is not a function","service":"medblock-backend","stack":"TypeError: logger.security is not a function\n    at authenticateToken (/home/josva/Desktop/MedBlock/src/middleware/auth.js:68:14)\n    at Layer.handle [as handle_request] (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:328:13)\n    at /home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:346:12)\n    at next (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:175:3)\n    at router (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:47:12)\n    at Layer.handle [as handle_request] (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/home/josva/Desktop/MedBlock/node_modules/express/lib/router/index.js:328:13)","timestamp":"2025-06-27 01:59:48"}
{"environment":"development","kind":"ObjectId","level":"error","message":"Delete patient failed: Cast to ObjectId failed for value \"bulk\" (type string) at path \"_id\" for model \"Patient\"","path":"_id","reason":{},"service":"medblock-backend","stack":"CastError: Cast to ObjectId failed for value \"bulk\" (type string) at path \"_id\" for model \"Patient\"\n    at SchemaObjectId.cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schema/objectId.js:251:11)\n    at SchemaType.applySetters (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schemaType.js:1255:12)\n    at SchemaType.castForQuery (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schemaType.js:1673:17)\n    at cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/cast.js:390:32)\n    at cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/cast.js:76:20)\n    at Query.cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:5055:12)\n    at Query._castConditions (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:2351:10)\n    at model.Query._findOne (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:2674:8)\n    at model.Query.exec (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:4604:80)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","stringValue":"\"bulk\"","timestamp":"2025-06-27 02:04:09","value":"bulk","valueType":"string"}
{"environment":"development","kind":"ObjectId","level":"error","message":"Delete patient failed: Cast to ObjectId failed for value \"invalid-id\" (type string) at path \"_id\" for model \"Patient\"","path":"_id","reason":{},"service":"medblock-backend","stack":"CastError: Cast to ObjectId failed for value \"invalid-id\" (type string) at path \"_id\" for model \"Patient\"\n    at SchemaObjectId.cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schema/objectId.js:251:11)\n    at SchemaType.applySetters (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schemaType.js:1255:12)\n    at SchemaType.castForQuery (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/schemaType.js:1673:17)\n    at cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/cast.js:390:32)\n    at cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/cast.js:76:20)\n    at Query.cast (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:5055:12)\n    at Query._castConditions (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:2351:10)\n    at model.Query._findOne (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:2674:8)\n    at model.Query.exec (/home/josva/Desktop/MedBlock/node_modules/mongoose/lib/query.js:4604:80)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","stringValue":"\"invalid-id\"","timestamp":"2025-06-27 02:19:54","value":"invalid-id","valueType":"string"}
